// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Industry {
  id        Int       @id @default(autoincrement())
  name      String
  companies Company[]
  screenerStatementId Int
}

model Company {
  id                  Int                      @id @default(autoincrement())
  name                String                   @unique
  slug                String                   @unique
  symbol              String                   @unique
  industry            Industry                 @relation(fields: [industryId], references: [id])
  industryId          Int // relation scalar field  (used in the `@relation` attribute above)
  balanceSheetId      Int
  profitLossId        Int
  companyEssentialsId Int
  companyRatioId      Int
  financialStatements FinancialStatementFact[]
  companyPrice        CompanyPrice[]
  stockHoldingFact    StockHoldingFact[]
}

model CompanyPrice {
  id               Int      @id @default(autoincrement())
  date             String
  noOfTransactions Int
  maxPrice         Float
  minPrice         Float
  closingPrice     Float
  tradedShares     Int
  amount           Float
  previousClosing  Float
  priceDifference  Float
  company          Company  @relation(fields: [companyId], references: [id])
  companyId        Int // relation scalar field  (used in the `@relation` attribute above)
}


model StockHoldingFact {
  id        Int      @id @default(autoincrement())
  name      String
  amount    Int
  date      String
  company   Company  @relation(fields: [companyId], references: [id])
  companyId Int
}

//FinancialStatement is the name of the financial report. The Income Statement, Balance Sheet is an example of a FinancialStatement
model FinancialStatement {
  id                     Int                              @id @default(autoincrement())
  name                   String
  financialStatementLine FinancialStatementLineSequence[]
}

//FinancialStatementLine is a single line-item on a FinancialStatement. An example would be Cost of Goods Sold, Share capital, Cash and cash equivalent
model FinancialStatementLine {
  id                      Int                              @id @default(autoincrement())
  name                    String                           @unique
  financialStatementFact  FinancialStatementFact[]
  financialStatement      FinancialStatementLineSequence[]
  parentId                Int?
  parent                  FinancialStatementLine?   @relation("ParentChild", fields: [parentId], references: [id])
  children                FinancialStatementLine[]  @relation("ParentChild")
  unit                    String
}

model FinancialStatementLineSequence {
  financialStatement       FinancialStatement     @relation(fields: [financialStatementId], references: [id])
  financialStatementId     Int
  financialStatementLine   FinancialStatementLine @relation(fields: [financialStatementLineId], references: [id])
  financialStatementLineId Int
  sequence                 Float
  @@id([financialStatementId, financialStatementLineId])
}

//FinancialStatementFact is the data for a FinancialStatementLine. For instance, what is the latest Cost of Revenue for Google?
model FinancialStatementFact {
  id                       Int                    @id @default(autoincrement())
  company                  Company                @relation(fields: [companyId], references: [id])
  companyId                Int // relation scalar field  (used in the `@relation` attribute above)
  financialStatementLine   FinancialStatementLine @relation(fields: [financialStatementLineId], references: [id])
  financialStatementLineId Int
  fiscalYear               Int
  quarter                  String
  amount                   Float
}

// model CompanyEssentialLine {
//   id       Int    @id @default(autoincrement())
//   name     String
//   sequence Int
//   unit     String
// }


// model CompanyRatioFacts {
//   id         Int     @id @default(autoincrement())
//   name       String
//   company    Company @relation(fields: [companyId], references: [id])
//   companyId  Int // relation scalar field  (used in the `@relation` attribute above)
//   fiscalYear Int
//   unit       String
//   amount     Float
// }